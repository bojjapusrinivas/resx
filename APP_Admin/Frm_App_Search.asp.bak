<%@ Language=VBScript %>
<!--#include file="../ASPIncludes_vizag/DBopen.asp"-->
<!--#include file="../ASPIncludes_vizag/ADOVBS.inc"-->
<!--#include file="../ASPIncludes_vizag/SendEmail.asp"-->
<%
function fnchecked(val1,val2)
		if (strComp(val1,val2,0) = 0 ) then
			fnchecked= "checked"
		else
			fnchecked= ""
		end if
end function
if trim(request("rId")) <> "" then

   seloppt = "OptResPho" & trim(request("rId"))
  ' Response.write (trim(request("rId")))
   'Response.write   request(seloppt)
'Interview_Gurgaon_Details
if trim(request(seloppt)) <> "" then  'and isnull(trim(request(seloppt))) then
con.open "Provider="&drivertype&";data source="&servertype&";uid="&userid&";pwd="&pwd&";initial catalog="&trim(dbname) 
 
sqlstr="insert into Interview_Hyd_Details (Rec_ID,Profile) values(" & trim(request("rId")) & ",'" & request(seloppt) & "')"
con.execute sqlstr
con.close()

response.write sqlstr
response.redirect("RegistrationSlots.asp")
end if

end if


If trim(session("User_Name"))="" then
	Response.Redirect ("Default.asp?message=sesexp")
End if

%>

<html>
<head>
<title>View Analysts Data</title>
<script language="JavaScript">
function submitval(actval)
{
	var updateval;
	updateval = confirm("Confirm, Do you want to send email.");
	if (updateval==true)
	{
		window.frmsis.method="post";
		window.frmsis.action="Frm_SIS_ViewSelectedSlots.asp";
		window.frmsis.submit();
	}	
}
function Validate(theForm)
{
  if (theForm.ID.value == "")
  {
    alert("Please Enter Candidate ID in the \"Candidate ID\" field.");
    theForm.ID.focus();
    return (false);
  }

return (true);
}
function OpenWin(num)
	{ 
		myWin = open("AnAApplicantIntinfoSearch.asp?ID="+num+"#callID1" ,"userwin","width=780,top=5,left=5,height=550,status=no,toolbar=no,menubar=no,scrollbars=yes,resizable=yes");
	}
function OpenWinInt(num)
	{ 
		myWin = open("Interviewinfo.asp?ID="+num+"" ,"userwin","width=880,top=320,left=200,height=630,status=no,toolbar=no,menubar=no,scrollbars=yes");
	}
function OpenWinInt1(num,sname)
	{ 
		myWin = open("Interviewinfo.asp?ID="+num+"&stname='"+sname +"'" ,"userwin","width=880,top=5,left=5,height=800,status=no,toolbar=no,menubar=no,scrollbars=yes");
	}

function OpenWin1(num)
{
		window.frmsis.method="post";
		window.frmsis.action="RegistrationSlots.asp?rid="+num;
		window.frmsis.submit();
}
</script>
<link href="../globind.css" rel="stylesheet" type="text/css">
</head>
<body topmargin="0" leftmargin="0" bottommargin="0" rightmargin="0">
<table width="100%" height="100%" align="center" border="0">			
<tr><td colspan="2" valign="top"><!--#include file="ASPIncludes/TopStrip.asp"--></td></tr>
<tr><td width="15%" height="100%" height="100%"  bgcolor="#9DC3F5" valign="top"><!--#include file="ASPIncludes/sideStrip.asp"--></td>
<td valign="top" align="center">
<table border="0" width="75%" bordercolor="#005563" cellspacing="0" cellpadding="0"> 
<tr><td height="10"></td></tr>
</table> 
 <%if trim(request("ttype"))="" then
	ttype = "All"
	ttype1 = ""
  else
    ttype = trim(request("ttype"))
	ttype1 = trim(request("ttype"))
  end if%>
<table border="1" width="95%" bordercolor="#005563" cellspacing="0" cellpadding="0" style="border-collapse:collapse;"> 
 <tr>
    <td width="100%" bgcolor="#3767A6"><p align="center"><strong><big><font color="#FFFFFF">Search Applications [<%=ttype%>]</font></big></strong></td>
  </tr>
  <tr>
    <td width="100%" bgcolor="#005563"><p align="center"><font color='red'>
    <%if trim(request("message"))="2" then%>
		Status Updated successfully
    <%end if%>
    </font></p></td>
  </tr>
  <form name="frmsis" method="post">
  <tr>
    <td width="100%"><div align="center"><center>
    <table align="center" width="100%" border="1" bordercolor="black" cellpadding="2" cellspacing="2" bgcolor="#C5D9F3" style="border-collapse:collapse;">
	<tr>
<td colspan="7" align="center"><b>Search In :</b> <input type="radio" value="Hyderabad" checked name="Applicationfor" >Hyderabad &nbsp;&nbsp;&nbsp; <input type="radio" value="Gurgaon" name="Applicationfor" >Gurgaon</td></tr>

<tr>
<td colspan="7">  <div align="center"><center><p><font color="#004080"><strong>Candidate Name/ID :</strong></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <input type="text" name="ID" size="25"></p>
          </center></div> </td>

</tr>
<tr>
<td colspan="7">  <div align="center"><center><p><font color="#004080"><strong>Candidate Surname :</strong></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <input type="text" name="txtSurname" size="25"></p>
          </center></div> </td>

</tr>
<tr>
<td colspan="7" align="center"><font color="#004080"><B>Candidate Phone :</B></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <input type="text" name="candPhone" size="20" MAXLENGTH="11"></td></tr>

<tr>
<td colspan="7" align="center"><font color="#004080"><B>Candidate Email :</B></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <input type="text" name="candEmail" size="20" MAXLENGTH="100"></td></tr>
<tr>
<tr>
<td colspan="7">  <div align="center"><center><p><font color="#004080"><strong>Candidate Special Skills  :</strong></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <input type="text" name="txtSkills" size="25"></p>
          </center></div> </td>

</tr>
<td colspan="7">  <div align="center"><center><p><input type="submit" value="Enter" name="Btn1"></p>
          </center></div> </td>

</tr>
	<tr>
		<td colspan="7">
		<%	
		''add data to database
		  '' for paging
		dim k,rec_per_page
		rec_per_page=50
		Dim Cp,rowcount,i
			cp=Request.QueryString("Cp")
			EforEdit=Request.QueryString("E")
		if cp="" then
			cp=1
			EforEdit=cint(rec_per_page)
		end if 
		cpForEdit=cp
		con.open "Provider="&drivertype&";data source="&servertype&";uid="&userid&";pwd="&pwd&";initial catalog="&trim(dbname)  			
		Set rsDisp =Server.CreateObject("ADODB.Recordset")
		rsDisp.ActiveConnection = con
		rsDisp.CursorType = 3
		rsDisp.PageSize = cint(rec_per_page)
		if Request("ID") <> "" then
		  if isnumeric(Request("ID")) then
			'Response.write (request("id"))
			whrcnd=" and rec_id=" & request("id") 
			'Response.write (session("user_type"))
		   else
			whrcnd=" and user_name like '%" & request("id") & "%' "
		   end if
		end if
		IF trim(request("candPhone")) <> "" THEN
		 	
		  whrcnd= whrcnd & " and User_phone like '" & trim(request("candPhone")) & "%' "

		end if
		if trim(request("txtSurname"))<>"" then
		        whrcnd= whrcnd & " and surname like '%" & request("txtSurname") & "%' "

		end if
		if trim(request("txtSkills"))<>"" then
		        whrcnd= whrcnd & " and special_skills like '%" & request("txtSkills") & "%' "

		end If
		if trim(request("candEmail"))<>"" then
		        whrcnd= whrcnd & " and user_email like '%" & request("candEmail") & "%'  or user_alternateemail like '%" & request("candEmail") & "%'"

		end If
		'Response.write whrcnd
		'if trim(session("user_type"))="1" then
		if trim(request("ID"))<>"" or trim(request("candPhone")) <> "" or trim(request("candEmail"))<>"" or trim(request("txtSurname")) <> ""  or trim(request("txtSkills"))<>""then		
			'if trim(session("user_type"))="4"  then
			
				usql1="select * from TBL_SIS_Applications where  (Applicationfor='" & trim(request("Applicationfor")) & "'  )" &   whrcnd & " order by user_name"
			
			'else
			'	usql1="select * from TBL_SIS_Applications where user_status not in (0,8,9) and Applicationfor='" & trim(request("Applicationfor")) & "'" &   whrcnd & " order by user_name"
			'end if
		
		'response.write usql1
		'response.end
		rsDisp.Open usql1
		'paging
		'rsDisp.movefirst
		rowcount = 0
		Start = 1
		E = cint(rec_per_page)
		i = rsDisp.RecordCount
		p = i
		if i>cint(rec_per_page) then
			Response.Write ("<table width='100%' style='border-collapse:collapse'><tr bgcolor='white'><td><font face=verdana size=2 color=""blue""><b>Pages:")
			for i=1 to rsDisp.PageCount%>			
				<a href="Frm_App_Search.asp?Start=<%=Start%>&amp;E=<%=E%>&amp;Cp=<%=i%>&candname=<%=trim(request("candname"))%>&txtSurname=<%=trim(request("txtSurname"))%>&candPhone=<%=trim(request("candPhone"))%>&txtSkills=<%=trim(request("txtSkills"))%>&Applicationfor=<%=trim(request("Applicationfor"))%>&id=<%=request("id")%>&ttype=<%=ttype1%>"><%=i%></a>			
				<% start = start+cint(rec_per_page)
				E = E+cint(rec_per_page)
			next 
		   	if cp >= 1 then
				Response.Write ("</td><td  align=right width='30%'><font size='2' face=verdana color=""blue""><b>Page :&nbsp;<b>"&Cp&"") 
			end if  
				Response.Write ("</td></tr></table>")
		end if 	
		if cp > 1 then		 	 
			 rsDisp.AbsolutePosition = Request.QueryString("Start")
		END IF 
		Response.Write ("<tr>")
			'Response.Write ("<th><font face=""verdana"" size=""2"">Option</font></th>")
			Response.Write ("<th><font face=""verdana"" size=""2"">Sl. No</font></th>")
			Response.Write ("<th><font face=""verdana"" size=""2"">User Name</font></th>")
			Response.Write ("<th><font face=""verdana"" size=""2"">Email ID</font></th>")
			Response.Write ("<th><font face=""verdana"" size=""2"">Phone</font></th>")
			Response.Write ("<th><font face=""verdana"" size=""2"">Application</font></th>")
			Response.Write ("<th><font face=""verdana"" size=""2"">Status</font></th>")
			'Response.Write ("<th><font face=""verdana"" size=""2"">Slots</font></th>")
			'Response.Write ("<th><font face=""verdana"" size=""2"">RESUME & PHOTOGRAPH</font></th>")
			Response.Write ("<th><font face=""verdana"" size=""2"">Options</font></th>")
		Response.Write ("</tr>")
		IF not rsDisp.EOF THEN
			j=1
			no = trim(Request.QueryString("Start"))
			if no = "" then
				no = 1
			else
				no = no
			end if
			startEdit=no
			while not rsDisp.EOF and rowcount<rsDisp.PageSize
				dim UsrStat
				if trim(rsDisp("User_Status"))="1" then
					UsrStat = "<font color='black'>Pending</font>"
				elseif trim(rsDisp("User_Status"))="2" then
					UsrStat = "<font color='green'>Approved</font>"
				elseif trim(rsDisp("User_Status"))="3" then
					UsrStat = "<font color='red'>Declined</font>"
				elseif trim(rsDisp("User_Status"))="5" then
					UsrStat = "<font color='blue'>Hold</font>"
				elseif trim(rsDisp("User_Status"))="8" then
					UsrStat = "<font color='red'>Blocked</font>"
				elseif trim(rsDisp("User_Status"))="4" then
					UsrStat = "<font color='blue'>Email Sent</font>"
				end if
				Response.Write ("<tr bgcolor='white'>")
					'if trim(ucase(rsDisp("mail_sent")))="Y" then
					'	Response.Write ("<td align='center'>-Sent-</td>")
					'else
					'	Response.Write ("<td align='center'><input type=""checkbox"" checked name=""chk"&rsDisp("Rec_id")&"""></td>")
					'end if
					Response.Write ("<td align='center'><a href='javascript:OpenWin("& rsDisp("Rec_id") &");'><font face='verdana' size='2'>"& no &"</font></a></td>")
					Response.Write ("<td align='left'><font face='verdana' size='2'>"& rsDisp("User_Name") & " " & rsDisp("SurName") &"("& rsDisp("Rec_id") &")</font></td>")
					Response.Write ("<td align='left'><font face='verdana' size='2'>"& rsDisp("User_Email") &"</font></td>")
					Response.Write ("<td align='left'><font face='verdana' size='2'>"& rsDisp("User_Phone") &"</font></td>")
					'Response.Write ("<td align='center'><font face='verdana' size='2'>"& rsDisp("Date_Updated") &"</font></td>")
					Response.Write ("<td align='left'><font face='verdana' size='2' ><b>"& rsDisp("Applicationfor") &"<b></font></td>")
					Response.Write ("<td align='left'><font face='verdana' size='2' ><b>"& UsrStat &"<b></font></td>")
					'Response.Write ("<td align='left'><font face='verdana' size='2' ><b><input type='radio' name='OptResPho" & rsDisp("Rec_id") & "' value='Only Resume'" &  fnchecked(trim(rsDisp("appeared")),"Only Resume") & " >Only Resume&nbsp;&nbsp;<input type='radio' name='OptResPho" & rsDisp("Rec_id") & "' value='Only Photos' " & fnchecked(trim(rsDisp("appeared")),"Only Photos")& " >Only Photos&nbsp;&nbsp;<input type='radio' name='OptResPho" & rsDisp("Rec_id") & "' value='Both' " & fnchecked(trim(rsDisp("appeared")),"Both") & " >Both&nbsp;&nbsp;"  &"<b></font></td>")
					'if trim(ucase(rsDisp("appeared")))<> "" then
						Response.Write ("<td align='center'><a href='javascript:OpenWin("& rsDisp("Rec_id") &");'><font face='verdana' size='2'>View</font></a></td>")
					'else
					'	Response.Write ("<td align='center'><a href='javascript:OpenWin1("& rsDisp("Rec_id") &");'><font face='verdana' size='2'>Appeared</font></a></td>")
					'end if
				Response.Write ("</tr>")
				j=j+1
				no=no+1
				rowcount=rowcount+1
			rsDisp.MoveNext
			wend
		else
			Response.Write ("<tr bgcolor='white'>")
					Response.Write ("<td colspan=7 align=center><font face='verdana' size='2' color='red'>-- No Records Found --</font></td>")					
			Response.Write ("</tr>")
		End if
		set rsDisp=nothing
		con.close()
	end if
		Response.Write ("<tr bgcolor='white'>")
				'Response.Write ("<td colspan=7 align=left><input type=""submit"" name=""butnvalue"" value=""Send mail"" onclick=""javascript:submitval('Accept')""></td>")					
		Response.Write ("</tr>")
		%>
	</table>
    </center></div></td>
  </tr>
  </form>
</table><br>
</td></tr>
<tr><td colspan="2">
<!--#include file="ASPIncludes/BottomStrip.asp"-->
</td></tr>
</table>
</center></div>
</body>
</html>
